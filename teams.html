<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±Ù‚</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      text-align: center;
      padding: 20px;
    }
    .team {
      margin: 10px;
      padding: 10px;
      border: 1px solid #555;
      border-radius: 8px;
      display: inline-block;
      width: 200px;
      background: #222;
    }
    button {
      margin-top: 8px;
      padding: 6px 12px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:disabled {
      background: gray;
      cursor: not-allowed;
    }
    input {
      margin: 6px;
      padding: 8px;
      border-radius: 6px;
      border: none;
      width: 200px;
    }
  </style>
</head>
<body>
  <h1>ğŸ“‹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±Ù‚</h1>

  <!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ -->
  <div id="register-section">
    <h2>ØªØ³Ø¬ÙŠÙ„</h2>
    <input type="text" id="playerName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" required><br>
    <input type="text" id="playerPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required><br>
    <button onclick="registerPlayer()">ØªØ³Ø¬ÙŠÙ„</button>
  </div>

  <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØ±Ù‚ -->
  <div id="teams-section" style="display:none;">
    <h2>Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ</h2>
    <div id="teams"></div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    // âœ… Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
    const firebaseConfig = {
      apiKey: "AIzaSyC9pbJ8dNc6wyYtpqosXKF1SgJzkJUmrGs",
      authDomain: "team-picker-869aa.firebaseapp.com",
      projectId: "team-picker-869aa",
      storageBucket: "team-picker-869aa.appspot.com",
      messagingSenderId: "63562988226",
      appId: "1:63562988226:web:8798646b64fa899f33dc9b",
      measurementId: "G-MNY4PS4D1Z"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
    let currentPlayerId = null;
    let currentPlayerName = null;

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨
    function registerPlayer() {
      const name = document.getElementById("playerName").value.trim();
      const phone = document.getElementById("playerPhone").value.trim();

      if (!name || !phone) {
        alert("ğŸš¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø¥Ø¬Ø¨Ø§Ø±ÙŠÙŠÙ†");
        return;
      }

      currentPlayerId = phone; // Ù†Ø®Ù„ÙŠ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù‡Ùˆ Ø§Ù„Ù€ ID
      currentPlayerName = name;

      localStorage.setItem("playerId", currentPlayerId);
      localStorage.setItem("playerName", currentPlayerName);

      document.getElementById("register-section").style.display = "none";
      document.getElementById("teams-section").style.display = "block";
    }

    // Ø¬Ù„Ø¨ Ø§Ù„ÙØ±Ù‚
    const teamsList = [
      "REAL MADRID", "ATLETICO MADRID", "FC BARCELONA", "VILLARREAL",
      "SEVILLA", "MAN UTD", "LIVERPOOL", "MAN CITY",
      "TOTTENHAM", "NEWCASTLE UNITED", "ARSENAL", "CHELSEA",
      "AC MILAN", "INTER MILAN", "ROMA", "JUVENTUS",
      "NAPOLI", "BAYERN MUNCHEN", "LEVERKUSEN", "DORTMUND",
      "PSG", "MARSEILLE", "MONACO", "AL NASR",
      "AL HILAL", "SPORTING LISBON", "BENFICA", "AJAX",
      "PSV", "FLAMENGO", "RIVER PLATE", "NOTTINGHAM FOREST"
    ];

    const teamsDiv = document.getElementById("teams");

    function renderTeams(snapshot) {
      teamsDiv.innerHTML = "";
      const selections = snapshot.val() || {};

      teamsList.forEach(team => {
        const selectedBy = Object.values(selections).find(sel => sel.team === team);
        const isTaken = !!selectedBy;

        const div = document.createElement("div");
        div.className = "team";

        div.innerHTML = `
          <h3>${team}</h3>
          <p>${isTaken ? "Ù…Ø£Ø®ÙˆØ° âœ… (" + selectedBy.name + ")" : "Ù…ØªØ§Ø­ ğŸŸ¢"}</p>
          <button onclick="pickTeam('${team}')" ${isTaken ? "disabled" : ""}>Ø§Ø®ØªØ±</button>
        `;

        teamsDiv.appendChild(div);
      });
    }

    db.ref("selections").on("value", renderTeams);

    // Ø§Ø®ØªÙŠØ§Ø± ÙØ±ÙŠÙ‚
    function pickTeam(team) {
      if (!currentPlayerId || !currentPlayerName) {
        alert("Ø³Ø¬Ù„ Ø£ÙˆÙ„Ø§ Ø¨Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ");
        return;
      }

      // ØªØ®Ø²ÙŠÙ† ÙÙ€ Firebase
      db.ref("selections/" + currentPlayerId).set({
        name: currentPlayerName,
        phone: currentPlayerId,
        team: team
      });
    }
  </script>
</body>
</html>
